<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}Dashboard - Wawalu{% endblock %}</title>

    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Material Symbols Outlined -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"
    />

    <!-- Tailwind CSS -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/output.css') }}"
    />

    <!-- Dashboard CSS -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/dashboard.css') }}"
    />

    {% block extra_css %}{% endblock %}
  </head>
  <body class="font-['Inter'] bg-gray-50">
    <div class="flex h-screen overflow-hidden">
      <!-- Sidebar -->
      <aside class="w-64 bg-white shadow-xl hidden md:flex flex-col z-20">
        <!-- Logo -->
        <div
          class="h-20 flex items-center justify-center border-b border-gray-100 px-6"
        >
          <a href="{{ url_for('index') }}" class="flex items-center gap-2">
            <img
              src="{{ url_for('static', filename='image/logo/logo.png') }}"
              alt="Wawalu"
              class="h-8 w-auto"
            />
            <span class="text-xl font-bold text-blue-600">awalu</span>
          </a>
        </div>

        <!-- User Info (Sidebar) -->
        <div
          class="p-6 border-b border-gray-100 flex flex-col items-center text-center"
        >
          <div
            class="w-20 h-20 rounded-full bg-blue-100 mb-3 overflow-hidden border-4 border-white shadow-sm"
          >
            {% if session.get('profile_image') %}
            <img
              src="{{ url_for('serve_image', table='users', id=session.get('user_id')) }}"
              alt="Profile"
              class="w-full h-full object-cover"
            />
            {% else %}
            <div
              class="w-full h-full flex items-center justify-center text-blue-500 text-3xl font-bold"
            >
              {{ session.get('user_name', 'U')[0] | upper }}
            </div>
            {% endif %}
          </div>
          <h3 class="font-bold text-gray-800 truncate w-full">
            {{ session.get('user_name', 'Usuario') }}
          </h3>
          <span
            class="text-xs text-blue-500 font-medium bg-blue-50 px-2 py-1 rounded-full mt-1 uppercase tracking-wide"
          >
            {{ session.get('user_role', 'padre') }}
          </span>
        </div>

        <!-- Navigation -->
        <nav class="flex-1 overflow-y-auto py-4 px-3 space-y-1">
          <!-- Common Links -->
          <a
            href="{{ url_for('dashboard') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'dashboard' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">dashboard</span>
            Dashboard
          </a>
          <a
            href="{{ url_for('profile') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'profile' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">person</span>
            Mi Perfil
          </a>

          <!-- Admin Navigation -->
          {% if session.get('user_role') == 'admin' %}
          <div
            class="pt-4 pb-2 px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider"
          >
            Gestión Académica
          </div>
          <a
            href="{{ url_for('manage_admissions') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_admissions' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">how_to_reg</span>
            Admisiones
          </a>
          <a
            href="{{ url_for('manage_enrollments') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_enrollments' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">assignment_ind</span>
            Matrículas
          </a>
          <a
            href="{{ url_for('manage_courses') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_courses' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">school</span>
            Cursos
          </a>
          <a
            href="{{ url_for('manage_programs') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_programs' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">menu_book</span>
            Programas
          </a>
          <a
            href="{{ url_for('manage_schedule') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_schedule' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">schedule</span>
            Horarios
          </a>
          <a
            href="{{ url_for('manage_assignments_admin') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_assignments_admin' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">assignment</span>
            Tareas
          </a>
          <a
            href="{{ url_for('manage_attendance') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_attendance' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">fact_check</span>
            Asistencia
          </a>
          <a
            href="{{ url_for('reports') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'reports' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">description</span>
            Reportes
          </a>
          <a
            href="{{ url_for('manage_reports') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_reports' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">upload_file</span>
            Gestión Reportes
          </a>
          <a
            href="{{ url_for('manage_events') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_events' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">calendar_month</span>
            Calendario
          </a>

          <div
            class="pt-4 pb-2 px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider"
          >
            Gestión Comercial
          </div>
          <a
            href="{{ url_for('manage_orders') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_orders' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">shopping_cart</span>
            Pedidos
          </a>
          <a
            href="{{ url_for('manage_products') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_products' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">storefront</span>
            Tienda
          </a>

          <div
            class="pt-4 pb-2 px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider"
          >
            Gestión Contenido
          </div>
          <a
            href="{{ url_for('manage_users') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_users' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">manage_accounts</span>
            Usuarios
          </a>
          <a
            href="{{ url_for('manage_news') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_news' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">newspaper</span>
            Noticias
          </a>
          <a
            href="{{ url_for('manage_galery') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_galery' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3"
              >gallery_thumbnail</span
            >
            Galería
          </a>
          <a
            href="{{ url_for('manage_comments') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_comments' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">comment</span>
            Comentarios
          </a>
          <a
            href="{{ url_for('manage_complaints') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_complaints' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">gavel</span>
            Reclamos
          </a>
          <a
            href="{{ url_for('menu') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'menu' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">restaurant_menu</span>
            Menú
          </a>

          <!-- Staff Navigation -->
          {% elif session.get('user_role') == 'staff' %}
          <div
            class="pt-4 pb-2 px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider"
          >
            Gestión Académica
          </div>
          <a
            href="{{ url_for('manage_admissions') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_admissions' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">how_to_reg</span>
            Admisiones
          </a>
          <a
            href="{{ url_for('manage_enrollments') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_enrollments' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">assignment_ind</span>
            Matrículas
          </a>
          <a
            href="{{ url_for('manage_schedule') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_schedule' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">schedule</span>
            Horarios
          </a>
          <a
            href="{{ url_for('manage_assignments_admin') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_assignments_admin' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">assignment</span>
            Tareas
          </a>
          <a
            href="{{ url_for('manage_attendance') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_attendance' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">fact_check</span>
            Asistencia
          </a>
          <a
            href="{{ url_for('reports') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'reports' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">description</span>
            Reportes
          </a>
          <a
            href="{{ url_for('manage_events') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_events' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">calendar_month</span>
            Calendario
          </a>

          <div
            class="pt-4 pb-2 px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider"
          >
            Gestión Comercial
          </div>
          <a
            href="{{ url_for('manage_orders') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_orders' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">shopping_cart</span>
            Pedidos
          </a>
          <a
            href="{{ url_for('manage_products') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_products' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">storefront</span>
            Tienda
          </a>

          <div
            class="pt-4 pb-2 px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider"
          >
            Gestión Contenido
          </div>
          <a
            href="{{ url_for('manage_users') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_users' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">manage_accounts</span>
            Usuarios
          </a>
          <a
            href="{{ url_for('manage_news') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_news' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">newspaper</span>
            Noticias
          </a>
          <a
            href="{{ url_for('manage_galery') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'manage_galery' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3"
              >gallery_thumbnail</span
            >
            Galería
          </a>
          <a
            href="{{ url_for('menu') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'menu' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">restaurant_menu</span>
            Menú
          </a>
          <a
            href="{{ url_for('shop') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'shop' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">storefront</span>
            Tienda
          </a>
          <a
            href="{{ url_for('news') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'news' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">newspaper</span>
            Noticias
          </a>

          <!-- Parent/Student Navigation -->
          {% else %}
          <div
            class="pt-4 pb-2 px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider"
          >
            Académico
          </div>
          <a
            href="{{ url_for('matricula') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'matricula' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">school</span>
            Matrícula
          </a>
          <a
            href="{{ url_for('student_grades') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'student_grades' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">grade</span>
            Notas
          </a>
          <a
            href="{{ url_for('student_attendance') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'student_attendance' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">fact_check</span>
            Asistencia
          </a>
          <a
            href="{{ url_for('student_schedule') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'student_schedule' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">schedule</span>
            Horario
          </a>
          <a
            href="{{ url_for('student_assignments') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'student_assignments' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3"
              >assignment_turned_in</span
            >
            Tareas
          </a>
          <a
            href="{{ url_for('student_messages') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'student_messages' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">mail</span>
            Mensajes
          </a>
          <a
            href="{{ url_for('reports') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'reports' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">assignment</span>
            Reportes
          </a>
          <a
            href="{{ url_for('calendar') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'calendar' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">calendar_month</span>
            Calendario
          </a>

          <div
            class="pt-4 pb-2 px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider"
          >
            Administrativo
          </div>
          <a
            href="{{ url_for('student_payments') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'student_payments' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">payments</span>
            Pagos
          </a>
          <a
            href="{{ url_for('student_documents') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'student_documents' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">folder_shared</span>
            Documentos
          </a>

          <div
            class="pt-4 pb-2 px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider"
          >
            Comunidad
          </div>
          <a
            href="{{ url_for('galery') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'galery' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3"
              >gallery_thumbnail</span
            >
            Galería
          </a>
          <a
            href="{{ url_for('shop') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'shop' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">storefront</span>
            Tienda
          </a>
          <a
            href="{{ url_for('news') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'news' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">newspaper</span>
            Noticias
          </a>
          <a
            href="{{ url_for('menu') }}"
            class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'menu' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
          >
            <span class="material-symbols-outlined mr-3">restaurant_menu</span>
            Menú
          </a>
          {% endif %}
        </nav>

        <!-- Logout -->
        <div class="p-4 border-t border-gray-100">
          <a
            href="{{ url_for('logout') }}"
            class="flex items-center px-4 py-3 text-red-500 rounded-lg hover:bg-red-50 transition-colors"
          >
            <span class="material-symbols-outlined mr-3">logout</span>
            Cerrar Sesión
          </a>
        </div>
      </aside>

      <!-- Main Content Wrapper -->
      <div class="flex-1 flex flex-col h-screen overflow-hidden">
        <!-- Mobile Header -->
        <header
          class="bg-white shadow-sm h-16 flex items-center justify-between px-4 md:hidden z-20"
        >
          <button
            id="mobile-sidebar-btn"
            class="text-gray-600 focus:outline-none"
          >
            <span class="material-symbols-outlined text-3xl">menu</span>
          </button>
          <div class="flex items-center gap-2">
            <img
              src="{{ url_for('static', filename='image/logo/logo.png') }}"
              alt="Wawalu"
              class="h-8 w-auto"
            />
            <span class="text-lg font-bold text-blue-600">awalu</span>
          </div>
          <div class="w-8"></div>
          <!-- Spacer for centering -->
        </header>

        <!-- Mobile Sidebar Overlay -->
        <div
          id="sidebar-overlay"
          class="fixed inset-0 bg-black/5 backdrop-blur-md z-30 hidden md:hidden"
        ></div>

        <!-- Mobile Sidebar -->
        <aside
          id="mobile-sidebar"
          class="fixed inset-y-0 left-0 w-64 bg-white shadow-2xl transform -translate-x-full transition-transform duration-300 ease-in-out z-40 md:hidden flex flex-col"
        >
          <!-- Same content as desktop sidebar but for mobile -->
          <div
            class="h-16 flex items-center justify-between border-b border-gray-100 px-6"
          >
            <span class="text-xl font-bold text-blue-600">Menú</span>
            <button id="close-sidebar-btn" class="text-gray-500">
              <span class="material-symbols-outlined">close</span>
            </button>
          </div>

          <!-- Mobile Nav Content (Cloned via JS or duplicated) -->
          <div
            class="p-6 border-b border-gray-100 flex flex-col items-center text-center"
          >
            <div
              class="w-16 h-16 rounded-full bg-blue-100 mb-3 overflow-hidden border-2 border-white shadow-sm"
            >
              {% if session.get('profile_image') %}
              <img
                src="{{ url_for('serve_image', table='users', id=session.get('user_id')) }}"
                alt="Profile"
                class="w-full h-full object-cover"
              />
              {% else %}
              <div
                class="w-full h-full flex items-center justify-center text-blue-500 text-2xl font-bold"
              >
                {{ session.get('user_name', 'U')[0] | upper }}
              </div>
              {% endif %}
            </div>
            <h3 class="font-bold text-gray-800 truncate w-full">
              {{ session.get('user_name', 'Usuario') }}
            </h3>
          </div>

          <nav class="flex-1 overflow-y-auto py-4 px-3 space-y-1">
            <!-- Common Links -->
            <a
              href="{{ url_for('dashboard') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors"
            >
              <span class="material-symbols-outlined mr-3">dashboard</span>
              Dashboard
            </a>
            <a
              href="{{ url_for('profile') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors"
            >
              <span class="material-symbols-outlined mr-3">person</span>
              Mi Perfil
            </a>

            <!-- Admin Navigation -->
            {% if session.get('user_role') == 'admin' %}
            <div
              class="pt-4 pb-2 px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider"
            >
              Gestión Académica
            </div>
            <a
              href="{{ url_for('manage_admissions') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors"
            >
              <span class="material-symbols-outlined mr-3">how_to_reg</span>
              Admisiones
            </a>
            <a
              href="{{ url_for('manage_enrollments') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors"
            >
              <span class="material-symbols-outlined mr-3">assignment_ind</span>
              Matrículas
            </a>
            <a
              href="{{ url_for('reports') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors"
            >
              <span class="material-symbols-outlined mr-3">assignment</span>
              Reportes
            </a>
            <a
              href="{{ url_for('manage_reports') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors"
            >
              <span class="material-symbols-outlined mr-3">upload_file</span>
              Gestión Reportes
            </a>
            <a
              href="{{ url_for('manage_events') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors"
            >
              <span class="material-symbols-outlined mr-3">calendar_month</span>
              Calendario
            </a>

            <div
              class="pt-4 pb-2 px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider"
            >
              Gestión Contenido
            </div>
            <a
              href="{{ url_for('manage_users') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors"
            >
              <span class="material-symbols-outlined mr-3"
                >manage_accounts</span
              >
              Usuarios
            </a>
            <a
              href="{{ url_for('manage_news') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors"
            >
              <span class="material-symbols-outlined mr-3">newspaper</span>
              Noticias
            </a>
            <a
              href="{{ url_for('manage_galery') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors"
            >
              <span class="material-symbols-outlined mr-3"
                >gallery_thumbnail</span
              >
              Galería
            </a>
            <a
              href="{{ url_for('manage_comments') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors"
            >
              <span class="material-symbols-outlined mr-3">comment</span>
              Comentarios
            </a>
            <a
              href="{{ url_for('manage_products') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors"
            >
              <span class="material-symbols-outlined mr-3">storefront</span>
              Tienda
            </a>
            <a
              href="{{ url_for('menu') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors"
            >
              <span class="material-symbols-outlined mr-3"
                >restaurant_menu</span
              >
              Menú
            </a>

            <!-- Staff Navigation -->
            {% elif session.get('user_role') == 'staff' %}
            <div
              class="pt-4 pb-2 px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider"
            >
              Gestión Académica
            </div>
            <a
              href="{{ url_for('manage_admissions') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors"
            >
              <span class="material-symbols-outlined mr-3">how_to_reg</span>
              Admisiones
            </a>
            <a
              href="{{ url_for('manage_enrollments') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors"
            >
              <span class="material-symbols-outlined mr-3">assignment_ind</span>
              Matrículas
            </a>
            <a
              href="{{ url_for('reports') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors"
            >
              <span class="material-symbols-outlined mr-3">assignment</span>
              Reportes
            </a>
            <a
              href="{{ url_for('manage_events') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors"
            >
              <span class="material-symbols-outlined mr-3">calendar_month</span>
              Calendario
            </a>
            <a
              href="{{ url_for('menu') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors"
            >
              <span class="material-symbols-outlined mr-3"
                >restaurant_menu</span
              >
              Menú
            </a>

            <!-- Parent/Student Navigation -->
            {% else %}
            <div
              class="pt-4 pb-2 px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider"
            >
              Académico
            </div>
            <a
              href="{{ url_for('matricula') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'matricula' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
            >
              <span class="material-symbols-outlined mr-3">school</span>
              Matrícula
            </a>
            <a
              href="{{ url_for('student_grades') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'student_grades' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
            >
              <span class="material-symbols-outlined mr-3">grade</span>
              Notas
            </a>
            <a
              href="{{ url_for('student_attendance') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'student_attendance' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
            >
              <span class="material-symbols-outlined mr-3">fact_check</span>
              Asistencia
            </a>
            <a
              href="{{ url_for('student_schedule') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'student_schedule' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
            >
              <span class="material-symbols-outlined mr-3">schedule</span>
              Horario
            </a>
            <a
              href="{{ url_for('student_assignments') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'student_assignments' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
            >
              <span class="material-symbols-outlined mr-3"
                >assignment_turned_in</span
              >
              Tareas
            </a>
            <a
              href="{{ url_for('student_messages') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'student_messages' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
            >
              <span class="material-symbols-outlined mr-3">mail</span>
              Mensajes
            </a>
            <a
              href="{{ url_for('reports') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'reports' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
            >
              <span class="material-symbols-outlined mr-3">assignment</span>
              Reportes
            </a>
            <a
              href="{{ url_for('calendar') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'calendar' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
            >
              <span class="material-symbols-outlined mr-3">calendar_month</span>
              Calendario
            </a>

            <div
              class="pt-4 pb-2 px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider"
            >
              Administrativo
            </div>
            <a
              href="{{ url_for('student_payments') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'student_payments' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
            >
              <span class="material-symbols-outlined mr-3">payments</span>
              Pagos
            </a>
            <a
              href="{{ url_for('student_documents') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'student_documents' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
            >
              <span class="material-symbols-outlined mr-3">folder_shared</span>
              Documentos
            </a>

            <div
              class="pt-4 pb-2 px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider"
            >
              Comunidad
            </div>
            <a
              href="{{ url_for('galery') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'galery' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
            >
              <span class="material-symbols-outlined mr-3"
                >gallery_thumbnail</span
              >
              Galería
            </a>
            <a
              href="{{ url_for('shop') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'shop' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
            >
              <span class="material-symbols-outlined mr-3">storefront</span>
              Tienda
            </a>
            <a
              href="{{ url_for('news') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'news' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
            >
              <span class="material-symbols-outlined mr-3">newspaper</span>
              Noticias
            </a>
            <a
              href="{{ url_for('menu') }}"
              class="flex items-center px-4 py-3 text-gray-600 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-colors {% if request.endpoint == 'menu' %}bg-blue-50 text-blue-600 font-medium{% endif %}"
            >
              <span class="material-symbols-outlined mr-3"
                >restaurant_menu</span
              >
              Menú
            </a>
            {% endif %}

            <a
              href="{{ url_for('logout') }}"
              class="flex items-center px-4 py-3 text-red-500 rounded-lg hover:bg-red-50 transition-colors mt-4"
            >
              <span class="material-symbols-outlined mr-3">logout</span>
              Cerrar Sesión
            </a>
          </nav>
        </aside>

        <!-- Main Content Area -->
        <main class="flex-1 overflow-y-auto bg-gray-50 p-4 md:p-8">
          <!-- Flash Messages -->
          <div id="flash-container-dashboard" class="mb-6 space-y-3">
            {% with messages = get_flashed_messages(with_categories=true) %}
              {% if messages %}
                {% for category, message in messages %}
                  <div class="flash-message bg-white rounded-lg shadow-lg border-l-4 p-4 flex items-start gap-3 transition-all duration-300
                    {% if category == 'success' %}border-green-500
                    {% elif category == 'error' %}border-red-500
                    {% elif category == 'warning' %}border-yellow-500
                    {% elif category == 'info' %}border-blue-500
                    {% else %}border-gray-500{% endif %}" role="alert">
                    
                    <!-- Icon -->
                    <div class="flex-shrink-0">
                      {% if category == 'success' %}
                        <span class="material-symbols-outlined text-green-500 text-2xl">check_circle</span>
                      {% elif category == 'error' %}
                        <span class="material-symbols-outlined text-red-500 text-2xl">error</span>
                      {% elif category == 'warning' %}
                        <span class="material-symbols-outlined text-yellow-500 text-2xl">warning</span>
                      {% elif category == 'info' %}
                        <span class="material-symbols-outlined text-blue-500 text-2xl">info</span>
                      {% else %}
                        <span class="material-symbols-outlined text-gray-500 text-2xl">notifications</span>
                      {% endif %}
                    </div>
                    
                    <!-- Message -->
                    <div class="flex-1 pt-0.5">
                      <p class="text-sm font-medium text-gray-900">{{ message }}</p>
                    </div>
                    
                    <!-- Close Button -->
                    <button type="button" class="flash-dismiss flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors">
                      <span class="material-symbols-outlined text-xl">close</span>
                    </button>
                  </div>
                {% endfor %}
              {% endif %}
            {% endwith %}
          </div>
          
          {% block content %}{% endblock %}
        </main>
      </div>
    </div>

    <script src="{{ url_for('static', filename='js/base_dashboard.js') }}"></script>
    <script src="{{ url_for('static', filename='js/flash_messages.js') }}"></script>
    {% block extra_js %}{% endblock %}
  </body>
</html>
