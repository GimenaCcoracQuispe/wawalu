{% extends "dashboard/base_dashboard.html" %} {% block title %}Matrícula -
Dashboard{% endblock %} {% block content %}
<div class="p-6 max-w-7xl mx-auto">
  <!-- Header -->
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-900 mb-2">Matrícula</h1>
    <p class="text-gray-600">Gestiona la matrícula de tus hijos</p>
  </div>

  <!-- Tabs -->
  <div class="mb-6 border-b border-gray-200">
    <nav class="flex space-x-8" aria-label="Tabs">
      <button
        id="tab-formulario"
        class="tab-button active border-b-2 border-blue-600 py-4 px-1 text-sm font-medium text-blue-600 whitespace-nowrap"
        onclick="switchTab('formulario')"
      >
        <span class="inline-flex items-center">
          <span class="material-symbols-outlined mr-2 text-[20px]"
            >edit_document</span
          >
          Formulario de Matrícula
        </span>
      </button>
      <button
        id="tab-historial"
        class="tab-button border-b-2 border-transparent py-4 px-1 text-sm font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap"
        onclick="switchTab('historial')"
      >
        <span class="inline-flex items-center">
          <span class="material-symbols-outlined mr-2 text-[20px]"
            >history</span
          >
          Historial de Matrículas
        </span>
      </button>
    </nav>
  </div>

  <!-- Tab Content: Formulario -->
  <div id="content-formulario" class="tab-content">
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-8">
      <div class="mb-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-2">Nueva Matrícula</h2>
        <p class="text-gray-600">
          Complete el formulario para matricular a su hijo/a
        </p>
      </div>

      <form
        id="matriculaForm"
        method="POST"
        action="{{ url_for('matricula') }}"
        enctype="multipart/form-data"
        class="space-y-8"
      >
        <!-- Sección: Datos del Estudiante -->
        <div class="border-l-4 border-blue-600 pl-6">
          <h3
            class="text-lg font-semibold text-gray-900 mb-4 flex items-center"
          >
            <span class="material-symbols-outlined mr-2 text-blue-600"
              >person</span
            >
            Datos del Estudiante
          </h3>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label
                for="student_first_name"
                class="block text-sm font-medium text-gray-700 mb-2"
              >
                Nombres <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="student_first_name"
                name="student_first_name"
                required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                placeholder="Nombres del estudiante"
              />
            </div>

            <div>
              <label
                for="student_last_name"
                class="block text-sm font-medium text-gray-700 mb-2"
              >
                Apellidos <span class="text-red-500">*</span>
              </label>
              <input
                type="text"
                id="student_last_name"
                name="student_last_name"
                required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                placeholder="Apellidos del estudiante"
              />
            </div>

            <div>
              <label
                for="student_dob"
                class="block text-sm font-medium text-gray-700 mb-2"
              >
                Fecha de Nacimiento <span class="text-red-500">*</span>
              </label>
              <input
                type="date"
                id="student_dob"
                name="student_dob"
                required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              />
            </div>

            <div>
              <label
                for="student_gender"
                class="block text-sm font-medium text-gray-700 mb-2"
              >
                Género <span class="text-red-500">*</span>
              </label>
              <select
                id="student_gender"
                name="student_gender"
                required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              >
                <option value="">Seleccione...</option>
                <option value="M">Masculino</option>
                <option value="F">Femenino</option>
              </select>
            </div>

            <div class="md:col-span-2">
              <label
                for="allergies"
                class="block text-sm font-medium text-gray-700 mb-2"
              >
                Alergias
              </label>
              <textarea
                id="allergies"
                name="allergies"
                rows="2"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                placeholder="Indique si el estudiante tiene alguna alergia"
              ></textarea>
            </div>

            <div class="md:col-span-2">
              <label
                for="medical_info"
                class="block text-sm font-medium text-gray-700 mb-2"
              >
                Información Médica
              </label>
              <textarea
                id="medical_info"
                name="medical_info"
                rows="2"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                placeholder="Condiciones médicas, medicamentos, etc."
              ></textarea>
            </div>
          </div>
        </div>

        <!-- Sección: Documentos Requeridos -->
        <div class="border-l-4 border-orange-600 pl-6">
          <h3
            class="text-lg font-semibold text-gray-900 mb-4 flex items-center"
          >
            <span class="material-symbols-outlined mr-2 text-orange-600"
              >upload_file</span
            >
            Documentos Requeridos
          </h3>

          <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
            <div class="flex items-start">
              <span class="material-symbols-outlined text-blue-600 mr-3 mt-0.5"
                >info</span
              >
              <div class="text-sm text-blue-800">
                <p class="font-semibold mb-1">Instrucciones:</p>
                <ul class="list-disc list-inside space-y-1">
                  <li>Formatos permitidos: JPG, JPEG, PNG, PDF</li>
                  <li>Tamaño máximo por archivo: 5MB</li>
                  <li>Las imágenes deben ser claras y legibles</li>
                </ul>
              </div>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- DNI Frontal -->
            <div>
              <label
                for="parent_id_front"
                class="block text-sm font-medium text-gray-700 mb-2"
              >
                DNI del Padre/Madre (Frontal)
                <span class="text-red-500">*</span>
              </label>
              <div class="relative">
                <input
                  type="file"
                  id="parent_id_front"
                  name="parent_id_front"
                  required
                  accept="image/jpeg,image/jpg,image/png,application/pdf"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"
                  onchange="validateFile(this)"
                />
              </div>
              <p class="text-xs text-gray-500 mt-1">
                Parte frontal del documento de identidad
              </p>
            </div>

            <!-- DNI Reverso -->
            <div>
              <label
                for="parent_id_back"
                class="block text-sm font-medium text-gray-700 mb-2"
              >
                DNI del Padre/Madre (Reverso)
                <span class="text-red-500">*</span>
              </label>
              <div class="relative">
                <input
                  type="file"
                  id="parent_id_back"
                  name="parent_id_back"
                  required
                  accept="image/jpeg,image/jpg,image/png,application/pdf"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"
                  onchange="validateFile(this)"
                />
              </div>
              <p class="text-xs text-gray-500 mt-1">
                Parte posterior del documento de identidad
              </p>
            </div>

            <!-- Certificado de Nacimiento -->
            <div>
              <label
                for="birth_certificate"
                class="block text-sm font-medium text-gray-700 mb-2"
              >
                Certificado de Nacimiento <span class="text-red-500">*</span>
              </label>
              <div class="relative">
                <input
                  type="file"
                  id="birth_certificate"
                  name="birth_certificate"
                  required
                  accept="image/jpeg,image/jpg,image/png,application/pdf"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"
                  onchange="validateFile(this)"
                />
              </div>
              <p class="text-xs text-gray-500 mt-1">
                Certificado de nacimiento del estudiante
              </p>
            </div>

            <!-- Foto del Estudiante -->
            <div>
              <label
                for="student_photo"
                class="block text-sm font-medium text-gray-700 mb-2"
              >
                Foto del Estudiante <span class="text-red-500">*</span>
              </label>
              <div class="relative">
                <input
                  type="file"
                  id="student_photo"
                  name="student_photo"
                  required
                  accept="image/jpeg,image/jpg,image/png"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"
                  onchange="validateFile(this)"
                />
              </div>
              <p class="text-xs text-gray-500 mt-1">
                Foto reciente del estudiante (tipo carnet)
              </p>
            </div>
          </div>
        </div>

        <!-- Sección: Programa Académico -->
        <div class="border-l-4 border-green-600 pl-6">
          <h3
            class="text-lg font-semibold text-gray-900 mb-4 flex items-center"
          >
            <span class="material-symbols-outlined mr-2 text-green-600"
              >school</span
            >
            Programa Académico
          </h3>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="md:col-span-2">
              <label
                for="program_id"
                class="block text-sm font-medium text-gray-700 mb-2"
              >
                Programa <span class="text-red-500">*</span>
              </label>
              <select
                id="program_id"
                name="program_id"
                required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              >
                <option value="">Seleccione un programa...</option>
                {% for program in programs %}
                <option value="{{ program.id }}">
                  {{ program.name }} - {{ program.description }}
                </option>
                {% endfor %}
              </select>
            </div>

            <div>
              <label
                for="enrollment_year"
                class="block text-sm font-medium text-gray-700 mb-2"
              >
                Año de Matrícula <span class="text-red-500">*</span>
              </label>
              <input
                type="number"
                id="enrollment_year"
                name="enrollment_year"
                required
                min="2024"
                max="2030"
                value="2025"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              />
            </div>

            <div>
              <label
                for="enrollment_period"
                class="block text-sm font-medium text-gray-700 mb-2"
              >
                Período <span class="text-red-500">*</span>
              </label>
              <select
                id="enrollment_period"
                name="enrollment_period"
                required
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              >
                <option value="">Seleccione...</option>
                <option value="I">Primer Semestre</option>
                <option value="II">Segundo Semestre</option>
                <option value="Anual">Anual</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Sección: Observaciones -->
        <div class="border-l-4 border-purple-600 pl-6">
          <h3
            class="text-lg font-semibold text-gray-900 mb-4 flex items-center"
          >
            <span class="material-symbols-outlined mr-2 text-purple-600"
              >note</span
            >
            Observaciones Adicionales
          </h3>

          <div>
            <label
              for="observations"
              class="block text-sm font-medium text-gray-700 mb-2"
            >
              Comentarios u Observaciones
            </label>
            <textarea
              id="observations"
              name="observations"
              rows="4"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              placeholder="Información adicional que considere relevante..."
            ></textarea>
          </div>
        </div>

        <!-- Botones -->
        <div
          class="flex items-center justify-end space-x-4 pt-6 border-t border-gray-200"
        >
          <button
            type="button"
            onclick="document.getElementById('matriculaForm').reset()"
            class="px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-colors"
          >
            Limpiar Formulario
          </button>
          <button
            type="submit"
            class="px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors shadow-sm hover:shadow-md flex items-center"
          >
            <span class="material-symbols-outlined mr-2 text-[20px]"
              >check_circle</span
            >
            Enviar Matrícula
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Tab Content: Historial -->
  <div id="content-historial" class="tab-content hidden">
    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-8">
      <div class="mb-6">
        <h2 class="text-2xl font-bold text-gray-900 mb-2">
          Historial de Matrículas
        </h2>
        <p class="text-gray-600">
          Revisa todas las matrículas que has realizado
        </p>
      </div>

      {% if enrollments and enrollments|length > 0 %}
      <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200">
          <thead class="bg-gray-50">
            <tr>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
              >
                Estudiante
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
              >
                Programa
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
              >
                Año/Período
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
              >
                Estado
              </th>
              <th
                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
              >
                Fecha
              </th>
            </tr>
          </thead>
          <tbody class="bg-white divide-y divide-gray-200">
            {% for enrollment in enrollments %}
            <tr class="hover:bg-gray-50">
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="flex items-center">
                  <div
                    class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-semibold"
                  >
                    {{ enrollment.student_name[0] }}
                  </div>
                  <div class="ml-4">
                    <div class="text-sm font-medium text-gray-900">
                      {{ enrollment.student_name }}
                    </div>
                  </div>
                </div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-gray-900">
                  {{ enrollment.program_name }}
                </div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-gray-900">
                  {{ enrollment.year }} - {{ enrollment.period }}
                </div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                {% if enrollment.status == 'active' %}
                <span
                  class="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800"
                >
                  Activa
                </span>
                {% elif enrollment.status == 'pending' %}
                <span
                  class="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800"
                >
                  Pendiente
                </span>
                {% else %}
                <span
                  class="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800"
                >
                  {{ enrollment.status }}
                </span>
                {% endif %}
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                {{ enrollment.created_at.strftime('%d/%m/%Y') if
                enrollment.created_at else 'N/A' }}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <div class="text-center py-12">
        <span class="material-symbols-outlined text-gray-300 text-[80px]"
          >assignment</span
        >
        <p class="mt-4 text-gray-500 text-lg">
          No tienes matrículas registradas aún
        </p>
        <p class="mt-2 text-gray-400">
          Completa el formulario para matricular a tu hijo/a
        </p>
        <button
          onclick="switchTab('formulario')"
          class="mt-6 px-6 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors inline-flex items-center"
        >
          <span class="material-symbols-outlined mr-2 text-[20px]">add</span>
          Nueva Matrícula
        </button>
      </div>
      {% endif %}
    </div>
  </div>
</div>

<script src="{{ url_for('static', filename='js/matricula.js') }}"></script>
{% endblock %}
